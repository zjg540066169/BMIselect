% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Spike_Laplace.R
\name{spike_laplace_mcmc}
\alias{spike_laplace_mcmc}
\title{Spike-and-Laplace MCMC Sampler for Multiply-Imputed Regression}
\usage{
spike_laplace_mcmc(
  X,
  Y,
  standardize = F,
  a = 2,
  b = NULL,
  prop_sd = 1,
  nburn = 4000,
  npost = 4000,
  seed = NULL,
  verbose = T,
  printevery = 1000,
  chain_index = 1
)
}
\arguments{
\item{X}{A 3D array of predictors with dimensions \code{D x n x p}.}

\item{Y}{A matrix of outcomes with dimensions \code{D x n}.}

\item{standardize}{Logical; whether to standardize \code{X} within each dataset. Default: \code{FALSE}.}

\item{a}{Shape parameter of Beta prior on inclusion probability. Default: \code{2}.}

\item{b}{Scale parameter of Beta prior (defaults to \code{2 * (D+1) / D} if not specified).}

\item{prop_sd}{Proposal standard deviation for log-normal Metropolis-Hastings updates of \code{lambda2}. Default: \code{1}.}

\item{nburn}{Number of burn-in iterations. Default: \code{4000}.}

\item{npost}{Number of posterior samples to store. Default: \code{4000}.}

\item{seed}{Optional random seed.}

\item{verbose}{Logical; whether to print MCMC progress. Default: \code{TRUE}.}

\item{printevery}{Print progress every \code{printevery} iterations. Default: \code{1000}.}

\item{chain_index}{Integer; index of the current MCMC chain (used for printing). Default: \code{1}.}
}
\value{
A list containing posterior draws of:
\describe{
\item{post_rho}{\code{npost} vector of global scale parameters.}
\item{post_Z}{\code{npost x p} matrix of binary inclusion indicators.}
\item{post_inclusion_prob}{\code{npost x p} posterior inclusion probabilities (marginalized).}
\item{post_theta}{\code{npost x p} matrix of inclusion probabilities per variable.}
\item{post_alpha}{\code{npost x D} matrix of intercepts.}
\item{post_lambda2}{\code{npost x p} matrix of local scale parameters.}
\item{post_accept_ratio}{\code{p}-length vector of MH acceptance rates for each \code{lambda2_j}.}
\item{post_sigma2}{\code{npost} vector of residual variances.}
\item{post_beta}{\code{npost x D x p} array of regression coefficients.}
\item{post_fitted_Y}{\code{npost x D x n} array of posterior predictive means (with noise).}
\item{post_pool_beta}{\code{(npost * D) x p} matrix; reshaped \code{post_beta} for pooling.}
\item{post_pool_fitted_Y}{\code{(npost * D) x n} matrix; reshaped \code{post_fitted_Y} for pooling.}
\item{a}{Shape parameter used for the Beta prior.}
\item{b}{Scale parameter used for the Beta prior.}
\item{prop_sd}{Proposal SD used in MH update of \code{lambda2}.}
}
}
\description{
Implements Bayesian variable selection using a spike-and-slab prior with a Laplace (double-exponential) slab
on nonzero coefficients. Latent inclusion indicators \code{Z} follow Bernoulli(\code{theta}), and their probabilities
follow independent Beta(\code{a}, \code{b}) priors. Local scales (\code{lambda2}) are updated via Metropolis-Hastings.
}
